(use-package perspective
  :hook (persp-created . dashboard-open)
  :bind
  ("C-x C-b" . persp-list-buffers)
  :custom
  (persp-mode-prefix-key (kbd "C-c M-p"))
  :init
  (persp-mode))

(defun my-perspective-mode-line ()
  "Customize perspective mode line to hide the status if there's only one perspective."
  (setq-default perspective-mode-line
                '(:eval
                  (if (<= (length (perspectives-hash)) 1)
                      ""
                    (format " Perspective[%s]"
                            (perspective-name (get-current-perspective)))))))

(add-hook 'persp-mode-hook 'my-perspective-mode-line)

(use-package persp-projectile
  :after perspective)
